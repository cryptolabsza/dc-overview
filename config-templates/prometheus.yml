global:
  scrape_interval: 15s
  evaluation_interval: 15s

rule_files:
  - "/etc/prometheus/recording_rules.yml"

scrape_configs:
  - job_name: "prometheus"
    metrics_path: /prometheus/metrics
    static_configs:
      - targets: ["localhost:9090"]

  # Node exporters - grouped by hostname
  - job_name: "master"
    static_configs:
      - targets: ["192.168.1.100:9100", "192.168.1.100:9835"]

  - job_name: "wk01"
    static_configs:
      - targets: ["192.168.1.101:9100", "192.168.1.101:9835"]

  - job_name: "wk03"
    static_configs:
      - targets: ["192.168.1.103:9100", "192.168.1.103:9835"]

  - job_name: "vastai-exporter"
    scrape_interval: 60s
    static_configs:
      - targets: ["192.168.1.100:8622"]
        labels:
          group: "vast"

  # IPMI Monitor metrics exporter
  # Note: Use Docker gateway IP (172.18.0.1) when Prometheus runs in Docker
  # and IPMI Monitor runs on the host. Use localhost:5000 if both run on host.
  - job_name: "ipmi-monitor"
    scrape_interval: 60s
    scrape_timeout: 30s
    static_configs:
      - targets: ["172.18.0.1:5000"]
        labels:
          group: "ipmi"
